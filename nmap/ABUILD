# ABUILD generated by mkpkg_generator.sh

pkgname=nmap
pkgver=6.25
pkgbuild=1
arch=("auto")

shortdesc=("nmap (network scanner)")
longdesc=("Nmap ("Network Mapper") is an open source utility for network exploration or security auditing. It was designed to rapidly scan large networks, although it works fine against single hosts. Nmap uses raw IP packets in novel ways to determine what hosts are available on the network, what services (ports) they are offering, what operating system (and OS version) they are running, what type of packet filters/firewalls are in use, and dozens of other characteristics. Nmap runs on most types of computers, and both console and graphical versions are available. http://nmap.org")

tags=("network net-analyzer")

source=("http://nmap.org/dist/${pkgname}-${pkgver}.tar.bz2")

build_deps="glibc-solibs lua openssl-solibs python libcap pcre"

build() {
    go_src_dir
    burn_patches
    ./configure --prefix=/usr --libdir=/usr/lib$LIBDIRSUFFIX --mandir=/usr/man --sysconfdir=/etc
    sed -e "s/^LIBS = -ldl -lnl/LIBS = -ldl -lnl-3/" -i ncat/Makefile
    sed "s|\$(LIBPCAPDIR)/libpcap.a|-lpcap|" -i nping/Makefile
    make -j${numjobs}
}

#BUILD_SYSTEM="autotools"
#BUILD_KEYS="--prefix=/usr --libdir=/usr/lib$LIBDIRSUFFIX --mandir=/usr/man --sysconfdir=/etc"
#INSTALL_KEYS="DESTDIR=$pkgdir"

after_build() {
  make DESTDIR=$pkgdir install
  go_src_dir
  rm "${pkgdir}"/usr/bin/uninstall_zenmap
}