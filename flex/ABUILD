# ABUILD generated by mkpkg_generator.sh

pkgname=flex
pkgver=2.5.39
pkgbuild=1
arch=("auto")

shortdesc=("flex (fast lexical analyzer generator)")
longdesc=("flex is a tool for generating programs that perform pattern matching on text. flex is a rewrite of the AT&T Unix lex tool (the two implementations do not share any code, though), with some extensions (and incompatibilities).")

tags=("develop sys-devel")

source=("http://downloads.sourceforge.net/sourceforge/flex/flex-$pkgver.tar.bz2")

build_deps="make gcc gcc-g++ glibc-solibs coreutils binutils sed grep gettext"

adddep="bash m4 bash"

BUILD_SYSTEM="autotools"
BUILD_KEYS="--prefix=/usr \
--libdir=/usr/lib$LIBDIRSUFFIX \
--mandir=/usr/man \
--docdir=/usr/doc/${pkgname}-${pkgver} \
--sysconfdir=/etc"

INSTALL_KEYS="DESTDIR=${pkgdir}"

after_build() {
  make check
  # these tests are incompatible with latest bison
  sed -i -e '/test-bison-yylloc/d' -e '/test-bison-yylval/d' tests/Makefile.in

  install -Dm0755 ${filedir}/lex.sh ${pkgdir}/usr/bin/lex
}
